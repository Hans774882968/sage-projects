

# This file was *autogenerated* from the file 5-绝谷野樵化简根式/solve_from_exp_demo.sage
from sage.all_cmdline import *   # import sage library

_sage_const_2 = Integer(2)
_sage_const_3 = Integer(3)
_sage_const_0 = Integer(0)
_sage_const_1 = Integer(1)
_sage_const_1181561441990592179994624 = Integer(1181561441990592179994624)
_sage_const_81603407194823067105148265404899470482484375 = Integer(81603407194823067105148265404899470482484375)
_sage_const_21 = Integer(21)
_sage_const_35245440741196617302016 = Integer(35245440741196617302016)
_sage_const_7892608445069503519090587539049078125 = Integer(7892608445069503519090587539049078125)
_sage_const_16 = Integer(16)
_sage_const_46707250582742167225531735007583744 = Integer(46707250582742167225531735007583744)
_sage_const_11 = Integer(11)
_sage_const_324355906824664483820669085470016 = Integer(324355906824664483820669085470016)
_sage_const_6 = Integer(6)
_sage_const_1760122403888730313240723940820939341615815741 = Integer(1760122403888730313240723940820939341615815741)
_sage_const_734430664753407603946334388644095234342359375 = Integer(734430664753407603946334388644095234342359375)
_sage_const_9 = Integer(9)
_sage_const_133499286575198878625564335276032 = Integer(133499286575198878625564335276032)
_sage_const_48356650965537404760532572501026687408268970488956181754528505 = Integer(48356650965537404760532572501026687408268970488956181754528505)
_sage_const_31 = Integer(31)
_sage_const_437160298923518417525035950530890825728 = Integer(437160298923518417525035950530890825728)
_sage_const_25 = Integer(25)
_sage_const_2308930146776356347363301121122751099590496256 = Integer(2308930146776356347363301121122751099590496256)
_sage_const_183755273669042138090023775503901412151422087858033490667208319 = Integer(183755273669042138090023775503901412151422087858033490667208319)
_sage_const_19 = Integer(19)
_sage_const_2532802265459246287004641431718651681311387971373568 = Integer(2532802265459246287004641431718651681311387971373568)
_sage_const_261125915213901985706875891505544112004652440640363381474453927 = Integer(261125915213901985706875891505544112004652440640363381474453927)
_sage_const_13 = Integer(13)
_sage_const_12421861495699225767169124748610490559803523996862140970057 = Integer(12421861495699225767169124748610490559803523996862140970057)
_sage_const_2611259152139019857068758915055441120046524406403633814744539270 = Integer(2611259152139019857068758915055441120046524406403633814744539270)
_sage_const_7 = Integer(7)
_sage_const_37917622176631976446499167875710503450442100746398622874916088699 = Integer(37917622176631976446499167875710503450442100746398622874916088699)
_sage_const_16537974630213792428102139795351127093627987907223014160048748710 = Integer(16537974630213792428102139795351127093627987907223014160048748710)
_sage_const_10360559 = Integer(10360559)
_sage_const_8459361 = Integer(8459361)
_sage_const_5 = Integer(5)
_sage_const_456335045 = Integer(456335045)
_sage_const_186298002 = Integer(186298002)
_sage_const_181447 = Integer(181447)
_sage_const_125007 = Integer(125007)
_sage_const_96538 = Integer(96538)
_sage_const_66360 = Integer(66360)
_sage_const_296 = Integer(296)
_sage_const_224 = Integer(224)
_sage_const_184 = Integer(184)
_sage_const_120 = Integer(120)
_sage_const_10 = Integer(10)


def solve_equation(c1, c2, c3, c4, pw, solve_last_poly=False):
    '''
    TODO: 这个文件的能力是 solve_sqrt236.sage 的子集，这里仅作为教程保留
    解方程`(a+b*sqrt(2)+c*sqrt(3))^pw == c1+c2*sqrt(2)+c3*sqrt(3)+c4*sqrt(6)`

    :param c1: 常数项
    :param c2: 根号2的系数
    :param c3: 根号3的系数
    :param c4: 根号6的系数
    :param pw: 幂
    :param solve_last_poly: 是否尝试解Grobner基的最后一个元素的方程
    '''
    S = PolynomialRing(QQ, order='lex', names=('a', 'b', 'c', 's2', 's3',))
    (a, b, c, s2, s3,) = S._first_ngens(5)
    I = S.ideal([s2 ** _sage_const_2 - _sage_const_2, s3 ** _sage_const_2 - _sage_const_3])
    Quo = S.quotient(I)
    expr = Quo(a + b * s2 + c * s3)
    expanded = expr ** pw
    rep = expanded.lift()
    # 现在 rep 是 a, b, c, s2, s3 的多项式，其中 s2, s3 次数 <= 1
    v1 = rep.coefficient({s2: _sage_const_0, s3: _sage_const_0})
    v2 = rep.coefficient({s2: _sage_const_1, s3: _sage_const_0})
    v3 = rep.coefficient({s2: _sage_const_0, s3: _sage_const_1})
    v4 = rep.coefficient({s2: _sage_const_1, s3: _sage_const_1})
    G = ideal(v1 - c1, v2 - c2, v3 - c3, v4 - c4).groebner_basis()
    print(G)
    last_var_poly = G[-_sage_const_1].factor()
    print(last_var_poly)
    if solve_last_poly:
        sols = solve(SR(last_var_poly), SR(c))
        print(sols)


def eq1_conclusion():
    b, c = var('b, c')
    eq = b - _sage_const_1181561441990592179994624 / _sage_const_81603407194823067105148265404899470482484375 * c ** _sage_const_21 + _sage_const_35245440741196617302016 / _sage_const_7892608445069503519090587539049078125 * c ** _sage_const_16 - _sage_const_46707250582742167225531735007583744 / \
        _sage_const_81603407194823067105148265404899470482484375 * c ** _sage_const_11 + _sage_const_324355906824664483820669085470016 / _sage_const_7892608445069503519090587539049078125 * c ** _sage_const_6 - _sage_const_1760122403888730313240723940820939341615815741 / _sage_const_734430664753407603946334388644095234342359375 * c
    eq_sub = eq.subs({c: _sage_const_9})
    print(eq_sub)  # b - 11


def eq2_conclusion():
    b, c = var('b, c')
    eq = b + _sage_const_133499286575198878625564335276032 / _sage_const_48356650965537404760532572501026687408268970488956181754528505 * c ** _sage_const_31 - _sage_const_437160298923518417525035950530890825728 / _sage_const_48356650965537404760532572501026687408268970488956181754528505 * c ** _sage_const_25 + _sage_const_2308930146776356347363301121122751099590496256 / _sage_const_183755273669042138090023775503901412151422087858033490667208319 * c ** _sage_const_19 - \
        _sage_const_2532802265459246287004641431718651681311387971373568 / _sage_const_261125915213901985706875891505544112004652440640363381474453927 * c ** _sage_const_13 + _sage_const_12421861495699225767169124748610490559803523996862140970057 / _sage_const_2611259152139019857068758915055441120046524406403633814744539270 * c ** _sage_const_7 - _sage_const_37917622176631976446499167875710503450442100746398622874916088699 / _sage_const_16537974630213792428102139795351127093627987907223014160048748710 * c
    eq_sub = eq.subs({c: _sage_const_9})
    print(eq_sub)  # b - 11


solve_equation(_sage_const_0, _sage_const_10360559, _sage_const_8459361, _sage_const_0, _sage_const_5)
solve_equation(_sage_const_456335045, _sage_const_0, _sage_const_0, _sage_const_186298002, _sage_const_6)
solve_equation(_sage_const_181447, _sage_const_125007, _sage_const_96538, _sage_const_66360, _sage_const_5)
solve_equation(-_sage_const_296, _sage_const_224, _sage_const_184, -_sage_const_120, _sage_const_5)
# 前两个例子分别是 (11 * sqrt2 + 9 * sqrt3) ^ 6, (11 * sqrt2 + 9 * sqrt3) ^ 5
# 后两个例子的Grobner基很简单： [a - 7/2*c, b - 3/2*c, c^5 - 32] [a + c, b - c, c^5 - 1]
# 分别解出 (7, 3, 2) (-1, 1, 1)
print('-' * _sage_const_10 + ' 人工写代码解Grobner基给我们的方程 ' + '-' * _sage_const_10)
eq1_conclusion()
eq2_conclusion()
